---
title: 共享内存
created: 2022-08-03 16:08:14
updated: 2022-10-06 16:59:44
tags: 
- atom
---

# 共享内存

共享内存（Shared Memory）是直接从内核维护的内存中划分一片内存，并将该内存映射到一个或多个[[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/进程|进程]]中。

![[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/z-attachments/Pasted image 20221006014232.png]]

因为可能多个进程映射到同一共享内存，所以某进程对此内存数据的修改会直接影响其它进程，这样就能在进程之间传递消息。但也正因为如此，在使用共享内存时，应当保证没有两个或以上的进程同时修改共享内存数据。

共享内存是效率最高的进程间通信方式，它完全内存化操作，且没有任何内存拷贝行为，此外，内存映射到不同进程之后，操作系统就不再参与该片内存的操作，用户进程可以有权访问这段内存。

内存共享和[[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/文件映射|文件映射]]非常像，不同之处就在**于共享内存没有对具体的磁盘文件进行映射，而是直接映射物理内存到进程中**。所以，它也映射在进程堆栈中间的那片未分配内存上。如图。

![[z-oblib/z2-attachments/Pasted image 20220803160824.png]]

## 编程接口

### 创建svipc对象

![[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/z-attachments/Pasted image 20221006155122.png]]

### 创建共享内存

![[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/z-attachments/Pasted image 20221006161526.png]]

### 共享内存与进程关联

![[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/z-attachments/Pasted image 20221006162428.png]]

### 共享内存与进程解绑

![[2_0_2-计算机科学/2_0_2_1_2_3-软件系统/2_0_2_1_2_3_1-操作系统/linux/z-attachments/Pasted image 20221006165944.png]]


