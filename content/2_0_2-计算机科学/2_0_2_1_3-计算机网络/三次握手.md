---
title: 三次握手
created: 2022-07-21 21:48:04
updated: 2022-09-18 22:16:03
tags: 
- atom
---

# 三次握手

客户端、服务端都要确认两件事：
1. 我发出去的包对面能不能收到
2. 对面发给我的包我能不能收到

> 这也是因为网络是全双工的，所以可以想成有两条道，双方都要确认这两条道路通畅。

1. 客户端向服务端发送一个控制位ACK=0，SYN=1的数据包表示请求建立连接，发送后客户端进入SYN-SENT状态。
	1. 此时，客户端虽然发出了数据，但是并不知道任何可用的信息。
2. 服务端接收到数据包后，分配缓存空间，并返回给客户端一个ACK=1，SYN=1的数据包，确认号ack为客户端数据包序列号加一，服务端进入SYN-RCVD状态。
	1. 服务端收到客户端的包后知道了：**客户端发给我的包，我能收到**。
	2. 客户端收到服务端的响应后知道：**服务端发给我的包，我能收到**。
	3. 根据包的ack和syn字段客户端还能知道：**我发给服务端的包，服务端能收到**。
> 这一步客户端一方想要的信息都齐了，但服务端还差一点。
3. 客户端接收到数据包后，返回给客户端ACK=1的数据包，进入Establish状态，传输连接正式建立。
	1. 服务端收到最终一步的包后知道：**我发给客户端的包，客户端能收到**。
