---
title: 指针
created: 2022-10-23 22:13:19
updated: 2022-10-25 00:57:12
tags: 
- atom
---

# 指针

指针变量本身就是一个数字，不存在内建的间接访问属性。除非显示的使用[[3-计算机科学/6-应用开发/0-软件语言/cpp/间接访问操作符|间接访问操作符]]。

## 未初始化和非法的指针

```c
int *a;
...
*a = 12;
```

a本身就是一个数字：
- a是一个自动变量，意味着未对其进行初始化前其值是垃圾。
- a是一个静态变量，意味着未显示初始化情况下其值始终为0。

## 指针的指针

```c
int a = 12;
int *b = &a;
int **c = &b;
```

## 指针表达式

涉及到[[3-计算机科学/6-应用开发/0-软件语言/cpp/变量的地址与值|变量的地址与值]]。

```c
char ch = 'a';
char *cp = &ch;
```

初始化如下：

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024005918.png]]

### ch

左值：表示表达式值为'a'

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010009.png]]

右值：表达式为内存的地址（而不是地址上存的值）：

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010053.png]]

### &ch

右值：变量ch的地址，但是&ch本身的存储位置不确定，可能是栈上，可能在寄存器里，所以浮空表示。
左值：&ch位置不确定，或者说该变量没有对应的地址信息，无法作为左值使用。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010125.png]]

### cp

右值：cp是一个指针变量，其值记录的是ch的地址。
左值：cp自己的地址。因为该表达式没有进行间接访问，所以没有箭头。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010336.png]]

### &cp

右值：取cp的地址值，但是取出来不确定放在哪里。
左值：&cp没有自身的地址信息，无法作为左值。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010542.png]]

### \*cp

右值：进行了一次间接访问，跳转到了ch的值
左值：进行了一次间接访问，跳转到了ch的地址

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024010720.png]]

### \*cp+1

右值：表达式最终结果存储位置未知，非法右值。
左值：取ch的地址值并+1。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024012149.png]]

### \*(cp+1)

右值：指针运算结果为右值。
左值：`*`操作符将指针运算cp+1的结果（一个常量）转为了左值。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024132113.png]]

### ++cp

表达式结果返回的是一个右值，同时会更新掉cp的值。先获取cp值拷贝并增加值大小，再返回。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024133848.png]]

## cp++

表达式结果返回的是一个右值，同时会更新掉cp的值。先返回cp值拷贝，再增加cp的值。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024134817.png]]

### \*++p

间接访问操作符作用于增值后的指针拷贝：

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024135020.png]]

### \*cp++

后缀++操作符优先级高于\*操作符：
1. ++操作符产生cp的一份拷贝
2. ++操作符增加cp的值
3. cp的拷贝上执行间接访问

> 该表达式常出现在循环体内用于一次访问数组内容。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024223350.png]]

### ++\*p

首先执行间接访问，再将cp指向位置上的值增加1，表达式结果是此时该值的一个拷贝。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221024225616.png]]

### (\*cp)++

与++\*p一样。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221025004740.png]]

### ++\*++cp

1. 执行++cp，返回增加后的cp的值的拷贝。
2. 对拷贝值进行左++操作。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221025005008.png]]

## ++\*cp++

1. 执行cp++，返回原cp值的拷贝值。
2. 执行对拷贝值的间接访问，效果等同于\*cp
3. 对cp所指向位置的值进行左++，返回增加后的拷贝值。

![[3-计算机科学/6-应用开发/0-软件语言/cpp/z-attachments/Pasted image 20221025005545.png]]

